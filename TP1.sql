CREATE TABLE PILOTE 
(	PLNUM NUMBER(3,0) NOT NULL ENABLE,  
PLNOM VARCHAR2(14 BYTE),  
PLPRENOM VARCHAR2(14 BYTE),  
VILLE VARCHAR2(14 BYTE),  
SALAIRE NUMBER(6), 
 PRIMARY KEY (PLNUM) 
);
CREATE TABLE AVION 
(	AVNUM NUMBER(3,0) NOT NULL ENABLE,  
AVNOM VARCHAR2(14 BYTE),  
CAPACITE NUMBER(6),  
LOCALISATION VARCHAR2(14 BYTE),  
 PRIMARY KEY (AVNUM) 
);

CREATE TABLE VOL 
(	VOLNUM NUMBER(3,0) NOT NULL ENABLE,  
PLNUM NUMBER(3,0) NOT NULL ENABLE,   
AVNUM NUMBER(3,0) NOT NULL ENABLE,  
VLLEDEP VARCHAR2(14 BYTE),  
VILLEARR VARCHAR2(14 BYTE),  
HEUREDEP VARCHAR2(14 BYTE),  
HEUREARR VARCHAR2(14 BYTE),  
 PRIMARY KEY (VOLNUM, PLNUM, AVNUM), 
 FOREIGN KEY (PLNUM) REFERENCES PILOTE (PLNUM), 
 FOREIGN KEY (AVNUM) REFERENCES AVION (AVNUM) 
);

////////// Insertion 
Insert into PILOTE (PLNUM,PLNOM,PLPRENOM,VILLE,SALAIRE) values (1,'MIRANDA','SERGE','PARIS',2600);

Insert into PILOTE (PLNUM,PLNOM,PLPRENOM,VILLE,SALAIRE) values (2,'LETHANH','NAHN','TOULOUSE',2100);

Insert into PILOTE (PLNUM,PLNOM,PLPRENOM,VILLE,SALAIRE) values (3,'TALADOIRE','GILLES','NICE',1800);

Insert into PILOTE (PLNUM,PLNOM,PLPRENOM,VILLE,SALAIRE) values (4,'CHARBONNIER','ANNETTE','PARIS',1700);

Insert into PILOTE (PLNUM,PLNOM,PLPRENOM,VILLE,SALAIRE) values (5,'REY','SERGE','TOULOUSE',1900);

Insert into PILOTE (PLNUM,PLNOM,PLPRENOM,VILLE,SALAIRE) values (6,'CHARBONNIER','FABIEN','PARIS',1800);

Insert into PILOTE (PLNUM,PLNOM,PLPRENOM,VILLE,SALAIRE) values (7,'PENAULD','PIERRE','NICE',1700);

Insert into PILOTE (PLNUM,PLNOM,PLPRENOM,VILLE,SALAIRE) values (8,'FOUILHOUX','PIERRE','LYON',1500);

Insert into PILOTE (PLNUM,PLNOM,PLPRENOM,VILLE,SALAIRE) values (9,'GANNAT','CHRISTOPHE','',1800);

Insert into PILOTE (PLNUM,PLNOM,PLPRENOM,VILLE,SALAIRE) values (10,'GADAIX','SONIA','PARIS',2000);

//////////// Avion
Insert into AVION (AVNUM,AVNOM,CAPACITE,LOCALISATION) values (1,'A300',300,'NICE');

Insert into AVION (AVNUM,AVNOM,CAPACITE,LOCALISATION) values (2,'A310',300,'SERGE');

Insert into AVION (AVNUM,AVNOM,CAPACITE,LOCALISATION) values (3,'B707',250,'SERGE');

Insert into AVION (AVNUM,AVNOM,CAPACITE,LOCALISATION) values (4,'A300',280,'SERGE');

Insert into AVION (AVNUM,AVNOM,CAPACITE,LOCALISATION) values (5,'CONCORDE',160,'SERGE');

Insert into AVION (AVNUM,AVNOM,CAPACITE,LOCALISATION) values (6,'B747',460,'SERGE');

Insert into AVION (AVNUM,AVNOM,CAPACITE,LOCALISATION) values (7,'B707',250,'SERGE');

Insert into AVION (AVNUM,AVNOM,CAPACITE,LOCALISATION) values (8,'A310',300,'SERGE');

Insert into AVION (AVNUM,AVNOM,CAPACITE,LOCALISATION) values (9,'MERCURE',180,'SERGE');

Insert into AVION (AVNUM,AVNOM,CAPACITE,LOCALISATION) values (10,'CONCORDE',160,'SERGE');

/////////// VOL


Insert into VOL (VOLNUM,PLNUM,AVNUM,VLLEDEP,VILLEARR,HEUREDEP,HEUREARR) values (100,1,1,'NICE','TOULOUSE',1100,1230);

Insert into VOL (VOLNUM,PLNUM,AVNUM,VLLEDEP,VILLEARR,HEUREDEP,HEUREARR) values (101,1,8,'PARIS','TOULOUSE',1700,1830);

Insert into VOL (VOLNUM,PLNUM,AVNUM,VLLEDEP,VILLEARR,HEUREDEP,HEUREARR) values (102,2,1,'TOULOUSE','LYON',1400,1600);

Insert into VOL (VOLNUM,PLNUM,AVNUM,VLLEDEP,VILLEARR,HEUREDEP,HEUREARR) values (103,5,3,'TOULOUSE','LYON',1800,2000);

Insert into VOL (VOLNUM,PLNUM,AVNUM,VLLEDEP,VILLEARR,HEUREDEP,HEUREARR) values (104,9,1,'PARIS','NICE',0645,0815);

Insert into VOL (VOLNUM,PLNUM,AVNUM,VLLEDEP,VILLEARR,HEUREDEP,HEUREARR) values (105,10,2,'LYON','NICE',1100,1200);

Insert into VOL (VOLNUM,PLNUM,AVNUM,VLLEDEP,VILLEARR,HEUREDEP,HEUREARR) values (106,1,4,'PARIS','LYON',0800,0900);

Insert into VOL (VOLNUM,PLNUM,AVNUM,VLLEDEP,VILLEARR,HEUREDEP,HEUREARR) values (107,8,4,'NICE','PARIS',0715,0845);

Insert into VOL (VOLNUM,PLNUM,AVNUM,VLLEDEP,VILLEARR,HEUREDEP,HEUREARR) values (108,1,8,'NANTES','LYON',0900,1530);

Insert into VOL (VOLNUM,PLNUM,AVNUM,VLLEDEP,VILLEARR,HEUREDEP,HEUREARR) values (109,8,2,'NICE','PARIS',1215,1345);

Insert into VOL (VOLNUM,PLNUM,AVNUM,VLLEDEP,VILLEARR,HEUREDEP,HEUREARR) values (110,9,2,'PARIS','LYON',1500,1600);

Insert into VOL (VOLNUM,PLNUM,AVNUM,VLLEDEP,VILLEARR,HEUREDEP,HEUREARR) values (111,1,2,'LYON','NANTES',1630,2000);

Insert into VOL (VOLNUM,PLNUM,AVNUM,VLLEDEP,VILLEARR,HEUREDEP,HEUREARR) values (112,4,5,'NICE','LENS',1100,1400);

Insert into VOL (VOLNUM,PLNUM,AVNUM,VLLEDEP,VILLEARR,HEUREDEP,HEUREARR) values (113,3,5,'LENS','PARIS',1500,1600);

Insert into VOL (VOLNUM,PLNUM,AVNUM,VLLEDEP,VILLEARR,HEUREDEP,HEUREARR) values (114,8,9,'PARIS','TOULOUSE',1700,1800);

Insert into VOL (VOLNUM,PLNUM,AVNUM,VLLEDEP,VILLEARR,HEUREDEP,HEUREARR) values (115,7,5,'PARIS','TOULOUSE',1800,1900);

////// Interrogation de la base
1)
select * from PILOTE;

2)
select PLNOM, VILLE from PILOTE;
3)
select PLNUM, PLNOM from pilote;

4)
//select VOLNUM, VLLEDEP from VOL;

select DISTINCT VLLEDEP From VOL;

5)
select PLNOM from PILOTE where VILLE = 'PARIS';

6)
select PLNOM from PILOTE where SALAIRE >= 2500;

7)
select PLNOM from pilote where VILLE is NULL;

8)
select * from AVION where AVNOM IN('A310', 'A320', 'A330', 'A340'); 

9)
select PLNOM from PILOTE where SALAIRE BETWEEN 2000 AND 2500;

10)
select CAPACITE from AVION where AVNOM like 'A%';

11)
select AVNOM from AVION where AVNOM NOT IN('A310', 'A320', 'A330', 'A340');

12)
select * from VOL where VLLEDEP = 'NICE' AND VILLEARR = 'PARIS';

13)
select AVG(SALAIRE) from PILOTE where VILLE ='PARIS';

14)
select COUNT(VOLNUM) from VOL where VLLEDEP = 'PARIS';

15)
select PLNOM from PILOTE where SALAIRE > (select AVG(SALAIRE) from PILOTE);

16)
SELECT PLNOM From PILOTE Where PLNUM IN ( SELECT DISTINCT PLNUM From VOL Where VLLEDEP='PARIS');

17)
select PLNOM from PILOTE where (VILLE = 'NICE' AND SALAIRE > ALL (select DISTINCT SALAIRE from PILOTE where VILLE = 'PARIS'));

18)
select PLNOM from PILOTE where (VILLE = 'NICE' AND SALAIRE > ANY (select DISTINCT SALAIRE from PILOTE where VILLE = 'PARIS'));

19)

SELECT PLNOM FROM PILOTE WHERE (VILLE, SALAIRE) IN (SELECT VILLE, SALAIRE FROM PILOTE WHERE PLNOM = 'MIRANDA');

20)
select * from PILOTE where VILLE = 'PARIS' order by SALAIRE DESC;
select * from PILOTE where VILLE = 'PARIS' order by PLNOM ASC;

21)
SELECT PLNUM,count(VOLNUM) FROM VOL GROUP BY PLNUM;

22)
SELECT AVNUM,PLNUM,count(VOLNUM) FROM VOL GROUP BY PLNUM, AVNUM;

23)
SELECT PLNUM,count(VOLNUM) FROM VOL GROUP BY PLNUM HAVING COUNT(VOLNUM) > 5;

24)
SELECT PLNUM,PLNOM FROM PILOTE WHERE PLNUM = (SELECT PLNUM FROM VOL GROUP BY PLNUM HAVING COUNT(VOLNUM) >= 5);

25)
select AVNOM from AVION where CAPACITE > 250 OR LOCALISATION = 'PARIS';

26)
select PLNUM from VOL where AVNUM IN (2,4);

27)
select PLNUM from VOL where AVNUM = 2 AND AVNUM Not IN (select PLNUM from VOL where AVNUM=4);

